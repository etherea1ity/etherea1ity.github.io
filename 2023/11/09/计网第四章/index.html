<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>计网第四章 | Jerryの魔法小屋</title><meta name="author" content="Jerry Jiang"><meta name="copyright" content="Jerry Jiang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="第四章 网络层重要内容 虚拟互联网的概念 IP地址与物理地址的关系 传统的分类的IP地址（包括子网掩码）和无分类域间路由选择 路由选择协议的工作方式  核心知识点 网络层的功能：  网络层面向无连接，不负责提供可靠的服务。将确保数据可靠的任务交给了上层的运输层（TCP协议）。 数据链路层是局域网内，而网络层将范围扩大至互联网，即世界上最大的互连网。负责为互联网上任意两台主机提供分组交换服务。">
<meta property="og:type" content="article">
<meta property="og:title" content="计网第四章">
<meta property="og:url" content="http://example.com/2023/11/09/%E8%AE%A1%E7%BD%91%E7%AC%AC%E5%9B%9B%E7%AB%A0/index.html">
<meta property="og:site_name" content="Jerryの魔法小屋">
<meta property="og:description" content="第四章 网络层重要内容 虚拟互联网的概念 IP地址与物理地址的关系 传统的分类的IP地址（包括子网掩码）和无分类域间路由选择 路由选择协议的工作方式  核心知识点 网络层的功能：  网络层面向无连接，不负责提供可靠的服务。将确保数据可靠的任务交给了上层的运输层（TCP协议）。 数据链路层是局域网内，而网络层将范围扩大至互联网，即世界上最大的互连网。负责为互联网上任意两台主机提供分组交换服务。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://imageurlbed.oss-cn-shenzhen.aliyuncs.com/img/mountains-7750722_1920.jpg">
<meta property="article:published_time" content="2023-11-09T12:05:34.000Z">
<meta property="article:modified_time" content="2023-11-09T12:06:20.291Z">
<meta property="article:author" content="Jerry Jiang">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://imageurlbed.oss-cn-shenzhen.aliyuncs.com/img/mountains-7750722_1920.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2023/11/09/%E8%AE%A1%E7%BD%91%E7%AC%AC%E5%9B%9B%E7%AB%A0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '计网第四章',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-11-09 20:06:20'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><script src="/live2d-widget/autoload.js"></script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://imageurlbed.oss-cn-shenzhen.aliyuncs.com/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://imageurlbed.oss-cn-shenzhen.aliyuncs.com/img/mountains-7750722_1920.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Jerryの魔法小屋"><span class="site-name">Jerryの魔法小屋</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">计网第四章</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-11-09T12:05:34.000Z" title="发表于 2023-11-09 20:05:34">2023-11-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-11-09T12:06:20.291Z" title="更新于 2023-11-09 20:06:20">2023-11-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/">计算机科学</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="计网第四章"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="第四章-网络层"><a href="#第四章-网络层" class="headerlink" title="第四章 网络层"></a>第四章 网络层</h2><h3 id="重要内容"><a href="#重要内容" class="headerlink" title="重要内容"></a>重要内容</h3><ul>
<li><strong>虚拟互联网</strong>的概念</li>
<li><strong>IP地址与物理地址</strong>的关系</li>
<li>传统的分类的IP地址（包括子网掩码）和无分类域间路由选择</li>
<li><strong>路由选择协议</strong>的工作方式</li>
</ul>
<h3 id="核心知识点"><a href="#核心知识点" class="headerlink" title="核心知识点"></a>核心知识点</h3><ol>
<li><p>网络层的功能：</p>
<ol>
<li>网络层<strong>面向无连接，不负责提供可靠的服务</strong>。将确保数据可靠的任务交给了上层的<strong>运输层（TCP协议</strong>）。</li>
<li>数据链路层是局域网内，而网络层将范围扩大至互联网，即世界上最大的互连网。<strong>负责为互联网上任意两台主机提供分组交换服务。</strong></li>
</ol>
</li>
<li><p>网络层向上只提供<strong>简单灵活的、无连接的、尽最大努力交付的</strong>数据报服务。不提供<strong>服务质量的承诺</strong>，使路由器比较简单。</p>
<ol>
<li>原因：计算机网络的端系统是<strong>具有智能的计算机</strong>，具有很强的<strong>差错处理能力</strong>。而传统电信网络的端系统是电话机，没有差错处理能力，所以要将确保可靠的任务交给网络层。</li>
<li>优点：<strong>网络造价大大降低，运行方式灵活，能够适应多种应用。</strong></li>
<li>如果主机（即端系统）中的进程之间的通信需要是可靠的，那么就由网络的主机中的运输层负责可靠交付（包括差错处理、流量控制等） 。</li>
</ol>
</li>
</ol>
<p>   <img src="https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%9C%8D%E5%8A%A1%E5%AF%B9%E6%AF%94.png" alt="服务对比"></p>
<p>   <strong>服务对比</strong></p>
<ol>
<li><p>主要协议：</p>
<ol>
<li><strong>网际协议IP（Internet Protocol）</strong>：Robert Kahn和Vint Cerf共同研发。</li>
<li><strong>地址解析协议ARP（Address Resolvotion Protocol）</strong>。</li>
<li><strong>网际控制报文协议ICMP（Internet Control Message Protocol）</strong>。</li>
<li><strong>网际组管理协议IGMP（Internet Group Management Protocol）</strong>。</li>
</ol>
</li>
<li><p><strong>虚拟互联网络</strong>的概念：</p>
<ol>
<li>即逻辑互联网络<strong>,忽略物理层的客观异构性,在网络层看起来好像是一个统一的网络</strong>,即互联网可以有多种异构的网络组成。（就像操作系统的逻辑设备一样，屏蔽差异）如果在这种覆盖全球的 IP 网的上层使用 TCP 协议，那么就是现在的<strong>互联网 Internet��������。</strong></li>
<li>网络互联的一些中间设备：<ol>
<li><strong>物理层：转发器、集线器</strong></li>
<li><strong>数据链路层：网桥（扩展局域网）</strong></li>
<li><strong>网络层：路由器（连接局域网）</strong></li>
<li><strong>网络层以上：网关、桥路器</strong></li>
</ol>
</li>
</ol>
</li>
<li><p>IP地址（<strong>RFC 791</strong>）:</p>
<ol>
<li><p>IP地址是给互联网上<strong>每一个主机（或路由器）的每一个接口</strong>分配一个在全世界范围内是<strong>唯一</strong>的<strong>32位（IPV4）</strong>的标识符。（<strong>MAC地址对每个计算机是固定的，IP地址不固定</strong>）。IP 地址现在由<strong>互联网名字和数字分配机构ICANN</strong>进行分配。<strong>每台主机或者路由器可以有多个IP地址。</strong></p>
</li>
<li><p>历史阶段：</p>
<ol>
<li><strong>分类的IP地址；</strong></li>
<li><strong>子网的划分；</strong></li>
<li><strong>构成超网。</strong></li>
</ol>
</li>
<li><p>组成：<strong>网络号net-id+主机号host-id。</strong></p>
<ol>
<li><strong>A类地址</strong>：<strong>8位网络号</strong>，第一位是标识位<strong>0</strong>；24位主机号。</li>
<li><strong>B类地址</strong>：<strong>16位网络号</strong>，前两位是标识位<strong>10</strong>；16位主机号。</li>
<li><strong>C类地址</strong>：<strong>24位网络号</strong>，前三位是标识位<strong>110</strong>；8位主机号。</li>
<li><strong>D类地址</strong>：前四位是标识位<strong>1110</strong>，用于<strong>一对多通信</strong>。</li>
<li><strong>E类地址</strong>：前四位是标识位<strong>1111</strong>，留作<strong>以后使用。</strong></li>
</ol>
</li>
</ol>
</li>
</ol>
<pre><code>  ![各类IP地址](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/%E5%90%84%E7%B1%BBIP%E5%9C%B0%E5%9D%80.png)

  **各类IP地址**
</code></pre><ol>
<li>IP地址的表示方法：<strong>点分十进制。</strong>每8个二进制转换为一个三位十进制数（0-255），插入一个点。IP地址在计算机中以二进制形式存储，但为了<strong>方便人类记忆</strong>，采用点分十进制的形式表示。</li>
</ol>
<pre><code>  ![点分十进制](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/%E7%82%B9%E5%88%86%E5%8D%81%E8%BF%9B%E5%88%B6.png)

  **点分十进制**
</code></pre><ol>
<li><p>IP地址的指派范围：</p>
<ol>
<li>A类地址网络号占用<strong>一个字节</strong>，但是由于有一位是类别位，<strong>只有7位可供使用</strong>，但是由于规定，<strong>网络字段全0是个保留字段表示本网络，而127（01111111）是另外一个保留字段，作为本地软件的环回测试。</strong>我们常见的127.0.0.1表示本机，原因也是出自这里。所以A类地址可以指派的网络号个数为<strong>（2^7-2）</strong>.</li>
<li>B类网络地址网络号有<strong>两个字节</strong>，前两位为10已经固定，<strong>只剩下14位可用</strong>，由于这14位无论怎么取值都不会使得网络号为全0或者全1，但实际上规定，<strong>规定B类最小网络地址为128.1.0.0</strong>。因此B类地址可指派的网络号个数为<strong>（2^14-1）.</strong></li>
<li>C类地址有<strong>3个字节</strong>的网络字段号，前三位固定110，<strong>只有剩下21位可用</strong>，同样C类地址可指派的最小网络地址也是<strong>192.0.1.0</strong>。因此C类地址可指派的网络号个数为<strong>（2^21-1）.</strong></li>
<li>A、B、C三类地址的主机号，<strong>全0或全1均有特殊作用</strong>，分别表示本主机和当前网络内全部主机，所以可用的主机号为<strong>（2^（n-1））</strong>。</li>
</ol>
</li>
</ol>
<pre><code>  ![IP地址范围](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/IP%E5%9C%B0%E5%9D%80%E8%8C%83%E5%9B%B4.png)

  **IP地址范围**
</code></pre><ol>
<li><p>一般不使用的特殊IP地址：</p>
<ol>
<li><strong>网络号全0：当前网络。</strong></li>
<li><strong>网络号全1：在本网络上进行广播。</strong></li>
<li><strong>网络号127：用于本地环回测试（自己连接自己）。</strong></li>
<li><strong>主机号全0：当前主机。</strong></li>
<li><strong>主机号全1：所有主机。</strong></li>
</ol>
</li>
</ol>
<pre><code>  ![不使用的IP地址](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/%E4%B8%8D%E4%BD%BF%E7%94%A8%E7%9A%84IP%E5%9C%B0%E5%9D%80.png)

  **不使用的IP地址**
</code></pre><ol>
<li><p>IP地址的重要特点：</p>
<ol>
<li><p>IP地址是一种</p>
<p>分等级</p>
<p>的地址结构。好处是：</p>
<ol>
<li>IP 地址管理机构在分配 IP 地址时<strong>只分配网络号</strong>，而剩下的主机号则由得到该网络号的单位自行分配。这样就<strong>方便了 IP 地址的管理</strong>。</li>
<li>路由器仅<strong>根据目的主机所连接的网络号</strong>来转发分组（而不考虑目的主机号），这样就可以<strong>使路由表中的项目数大幅度减少，从而减小了路由表所占的存储空间</strong>。 （转发到目的网络后，由目的网络的路由器转发至具体的主机）</li>
</ol>
</li>
<li><p>实际上 IP 地址是</p>
<p>标志一个主机（或路由器）和一条链路的接口。</p>
<ol>
<li><strong>多归属主机</strong>：当一个主机同时连接到两个网络上时，该主机就必须<strong>同时具有两个相应的 IP 地址</strong>，其网络号 net-id 必须是不同的。</li>
<li><strong>路由器</strong>：由于一个路由器<strong>至少应当连接到两个网络</strong>（这样它才能将 IP 数据报从一个网络转发到另一个网络），因此一个路由器<strong>至少应当有两个不同的 IP 地址</strong>。</li>
</ol>
</li>
<li><p>用<strong>转发器（物理层）或网桥（数据链路层）</strong>连接起来的若干个局域网仍为一个网络，因此这些局域网都具有同样的网络号 net-id。（<strong>网络层的路由器才是连接不同网络的中继系统</strong>）前者仅仅是<strong>扩展局域网</strong>，后者是<strong>连通局域网</strong>。</p>
</li>
<li><p>所有分配到网络号 net-id 的网络，无论是范围很小的局域网，还是可能覆盖很大地理范围的广域网，都是<strong>平等的。</strong></p>
</li>
</ol>
</li>
<li><p>IP地址与硬件地址的区别：</p>
<ol>
<li><strong>硬件地址（或物理地址、MAC地址）</strong>是<strong>数据链路层和物理层</strong>使用的地址。而<strong>IP 地址</strong>是<strong>网络层和以上各层</strong>使用的地址，是一种<strong>逻辑地址</strong>（称 IP 地址是逻辑地址是因为 IP 地址是用软件实现的）</li>
<li><strong>IP 地址放在 IP 数据报的首部，而硬件地址则放在 MAC 帧的首部</strong>。当已知主机或路由器的IP地址后，需要通过<strong>ARP地址</strong>解析协议得出其MAC地址。</li>
<li>网络层只能看见IP地址，数据链路层只能看见硬件地址。</li>
<li>分组每次经过路由器转发时都要将MAC帧的首部和尾部丢弃重新封装——<strong>变换MAC帧中的目的MAC地址和源MAC地址。而IP数据报中的源IP地址和目的IP地址始终不变。</strong></li>
</ol>
</li>
</ol>
<pre><code>  ![IP地址与硬件地址](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/IP%E5%9C%B0%E5%9D%80%E4%B8%8E%E7%A1%AC%E4%BB%B6%E5%9C%B0%E5%9D%80.png)

  **IP地址与硬件地址**
</code></pre><ol>
<li><p><strong>地址解析协议ARP</strong>：</p>
<ol>
<li><p>ARP 作用：<strong>从网络层使用的 IP 地址，解析出在数据链路层使用的硬件地址。</strong></p>
</li>
<li><p><strong>ARP高速缓存</strong>：每一个主机都设有一个 <strong>ARP 高速缓存 ARPcache������ℎ�\</strong>，里面有所在的局域网上的各主机和路由器的 IP 地址到硬件地址的映射表，条目为<strong>&lt; IP address；MAC address；TTL &gt;</strong>，其中<strong>TTL为地址映射有效时间</strong> 。<strong>ARP高速缓存动态更新</strong>。</p>
</li>
<li><p>ARP流程：</p>
<ol>
<li>当主机 A 欲向本局域网上的某个主机 B 发送 IP 数据报时，就先<strong>在其 ARP 高速缓存中查看有无主机 B 的 IP 地址</strong>。</li>
<li>如有，就可查出其对应的硬件地址，再将此硬件地址<strong>写入 MAC 帧，</strong>然后通过局域网将该 MAC 帧发往此硬件地址。</li>
<li>如没有， ARP 进程在本局域网上<strong>广播</strong>发送一个 <strong>ARP 请求分组</strong>。收到 <strong>ARP 响应分组</strong>后，将得到的 IP 地址到硬件地址的映射写入 <strong>ARP 高速缓存</strong>。并写入MAC帧进行发送。</li>
</ol>
</li>
<li><p>要点：</p>
<ol>
<li><strong>ARP请求分组</strong>：包含发送方硬件地址 / 发送方 IP 地址 / <strong>目标方硬件地址未知时填0，由接收方填写未知时填0，由接收方填写</strong> / 目标方 IP 地址。</li>
<li><strong>ARP 响应分组</strong>：包含发送方硬件地址 / 发送方 IP地址 / 目标方硬件地址 / 目标方 IP 地址。</li>
<li>ARP 分组封装在物理网络的<strong>帧</strong>中传输。</li>
<li>本地广播 ARP 请求（<strong>路由器不转发ARP请求</strong>）。<strong>ARP 是解决同一个局域网上的主机或路由器的 IP 地址和硬件地址的映射问题</strong>。一个主机想解析出另一个局域网上主机的MAC地址，需要先通过ARP找到当前局域网的一个路由器的MAC地址并发送，再通过它的转发表层层进行ARP操作并转发，直到找到目的主机所在的网络的一个路由器，由它广播ARP请求分组，获取目的主机的硬件地址。</li>
<li>从硬件地址到IP地址的解析每次转发分组时都要重复进行，但这种开销是不可避免的，是为<strong>方便的在各种异构网络之间进行转发工作而屏蔽网络硬件之间的异构性</strong>，从而体现出虚拟网络的含义。</li>
<li>为什么不统一使用硬件地址进行通信？<strong>由于全世界存在着各式各样的网络，它们使用不同的硬件地址。</strong>要使这些异构网络能够互相通信就必须进行非常复杂的硬件地址转换工作，因此几乎是不可能的事。IP 编址把这个复杂问题解决了。因此，<strong>在虚拟的 IP 网络上用 IP 地址进行通信给广大的计算机用户带来了很大的方便。</strong>（<strong>IP地址是虚拟网络的重要手段，屏蔽了不同网络之间的硬件地址差异）</strong></li>
</ol>
</li>
</ol>
</li>
</ol>
<pre><code>  ![ARP](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/ARP.png)

  **ARP**
</code></pre><ol>
<li><p><strong>IP数据报（又称分组</strong>）：</p>
<ol>
<li>由<strong>首部和数据部分</strong>组成。首部固定长度为<strong>20字节</strong>，此外还可加入长度可变的<strong>可选字段</strong>，总长度必须是<strong>4字节的倍数</strong>，最大为<strong>60字节</strong>。数据报总长度最大不能超过数据链路层协议规定的<strong>最大传送单元MTU，即1500字节</strong>，否则需要进行<strong>分片处理</strong>。</li>
</ol>
</li>
</ol>
<pre><code>  ![IP数据报](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/IP%E6%95%B0%E6%8D%AE%E6%8A%A5.png)

  **IP数据报**
</code></pre><ol>
<li><p>首部固定字段：</p>
<ol>
<li><p><strong>版本</strong>——<strong>占 4 位</strong>，指 <strong>IP 协议的版本</strong>。目前的 IP 协议版本号为 <strong>4 即IPv4即���4</strong>。</p>
</li>
<li><p><strong>首部长度</strong>——<strong>占 4 位</strong>，可表示的最大数值是 <strong>15 个单位一个单位为4字节一个单位为4字节\</strong>，因此 IP 的首部长度的最大值是 *<em>60 字节<strong>。（</strong>最小值为固定长度20字节*</em>）</p>
</li>
<li><p><strong>区分服务</strong>——<strong>占 8 位</strong>，用来获得更好的服务。只有在使用区分服务（DiffServ）时，这个字段才起作用。在一般的情况下都<strong>不使用</strong>这个字段 。</p>
</li>
<li><p><strong>总长度——占 16 位</strong>，<strong>指首部和数据之和的长度</strong>，单位为字节，因此数据报的理论最大长度为 <strong>65535 字节</strong>。但实际上，总长度必须不超过最大传送单元 MTU，否则需要<strong>分片</strong>。例如，<strong>以太网的MTU规定为1500字节</strong>。</p>
</li>
<li><p><strong>标识identification��������������</strong> ——<strong>占 16 位</strong>，它是一个计数器，用来产生 <strong>IP 数据报的标识</strong>。作用是：分片时，为各数据报片设定一个标识，<strong>相同标识的数据报片最终可被重新拼接起来</strong>。</p>
</li>
<li><p><strong>标志flag����</strong> ——<strong>占 3 位</strong>，目前只有低两位有意义。同样是为了分片。</p>
<ol>
<li>标志字段的最低位是 <strong>MF MoreFragment������������\</strong>。<strong>MF=1 表示后面“还有分片”。MF=0 表示最后一个分片。</strong></li>
<li>标志字段中间的一位是 <strong>DF Don′tFragment���′���������</strong> 。只有当 <strong>DF=0 时才允许分片。</strong></li>
</ol>
</li>
<li><p><strong>片偏移——占13 位</strong>，指出：<strong>较长的分组在分片后某片在原分组中的相对位置</strong>。片偏移以 <strong>8 个字节</strong>为偏移单位，除最后一个数据报片外，所有数据报片的长度都是<strong>8字节的倍数</strong>。保证最后数据报片可按照正确的顺序拼接回来。</p>
<ol>
<li>各片可以继承原IP数据报的首部，但必须更改以下字段：<ol>
<li>修改各数据报片的<strong>总长度字段。</strong></li>
<li>修改各数据报片的<strong>标识字段。</strong></li>
<li>修改各数据报片的<strong>片偏移字段。</strong></li>
<li>修改各数据报片的<strong>标志字段。</strong></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<pre><code>     ![分片](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/%E5%88%86%E7%89%87.png)

     **分片**





     ![分片结果](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/%E5%88%86%E7%89%87%E7%BB%93%E6%9E%9C.png)

     **分片结果**



  8. **协议——占8 位**，指出此数据报携带的数据**使用何种协议（TCP/UDP）**，以便目的主机的 IP 层将数据部分上交给那个处理过程。

  9. **生存时间——占8 位**，记为 **TTL TimeToLive����������\**，指示数据报在网络中**可通过的路由器数**的最大值。

  10. **首部检验和——占16 位**，为了减少工作量，只检验数据报的首部，不检验数据部分。这里不采用 CRC 检验码而采用简单的计算方法

      1. 方法：IP 数据报首部检验和的计算采用 **16 位二进制反码求和算法**
      2. 过程：在发送方将IP数据报的首部**划分为许多16位的字序列**；并把检验和字段置零，用**反码运算术将字相加**之后，将得到的和的**反码**写入检验和位置；在接受方接收到数据报之后，使用相同的方法将首部所有的字（包括检验和）相加一次，若没有出错则得到的结果**必然为零**，最后的结果便可作为是否出错的判断标志；
      3. **反码运算**：在普通的二进制加法的基础上，最高位如果产生进位，需要将最后的结果加1。

  11. **源IP地址和目的IP地址都各占 4 字节，32位。**
</code></pre><ol>
<li><strong>首部可变字段</strong>：IP 首部的可变部分就是一个选项字段，用来支持<strong>排错、测量以及安全</strong>等措施，内容很丰富。0到40字节。</li>
</ol>
<ol>
<li><p>网络层转发分组的流程：</p>
<ol>
<li><p>每一台主机都有一个<strong>路由表</strong>。按主机所在的网络地址来制作路由表.</p>
</li>
<li><p>在路由表中，对每一条路由，最主要的是<strong>（目的网络地址，下一跳地址）</strong>。具体如何选择路径需要依据<strong>路由选择协议</strong>，如内部网关协议<strong>RIP或OSPF。</strong></p>
</li>
<li><p>根据目的网络地址就能确定下一跳路由器，这样做的结果是：</p>
<ol>
<li>IP 数据报最终一定可以找到<strong>目的主机所在目的网络上的路由器</strong>（可能要通过多次的间接交付）。</li>
<li>只有到达最后一个路由器时，才试图向目的主机进行<strong>直接交付</strong>。</li>
</ol>
</li>
</ol>
</li>
</ol>
<pre><code>  ![路由转发](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/%E8%B7%AF%E7%94%B1%E8%BD%AC%E5%8F%91.png)

  **路由转发**
</code></pre><ol>
<li><p><strong>特定主机路由</strong>：虽然互联网所有的分组转发都是基于目的主机所在的网络，但在大多数情况下都允许有这样的特例，<strong>即为特定的目的主机指明一个路由</strong>。采用特定主机路由可使网络管理人员能更方便地控制网络和测试网络，同时也可在需要考虑某种安全问题时采用这种特定主机路由。</p>
</li>
<li><p><strong>默认路由</strong>：路由器还可采用默认路由以<strong>减少路由表所占用的空间和搜索路由表所用的时间。</strong></p>
</li>
</ol>
<pre><code>  ![默认路由](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/%E9%BB%98%E8%AE%A4%E8%B7%AF%E7%94%B1.png)

  **默认路由**
</code></pre><ol>
<li><p>每一次转发分组时，<strong>IP数据报中的IP源、目的地址不变，变的只是MAC地址</strong>。路由器的网络接口软件使用 ARP 负责将下一跳路由器的 IP 地址转换成硬件地址，并将此硬件地址放在链路层的 MAC 帧的首部，然后根据这个硬件地址找到下一跳路由器。</p>
</li>
<li><p>路由器分组转发算法：</p>
<ol>
<li>从数据报的首部提取目的主机的 IP 地址 D, 根据<strong>子网掩码</strong>得出目的网络地址为 N。</li>
<li>若网络 N 与此路由器<strong>直接相连</strong>，则把数据报直接交付目的主机 D；否则是间接交付，执行 33。</li>
<li>若路由表中有<strong>目的地址为 D 的特定主机路由</strong>，则把数据报传送给路由表中所指明的下一跳路由器；否则，执行 44。</li>
<li>若路由表中有<strong>到达网络 N 的路由</strong>，则把数据报传送给路由表指明的下一跳路由器；否则，执行 55。</li>
<li>若路由表中有一个<strong>默认路由</strong>，则把数据报传送给路由表中所指明的默认路由器；否则，执行 66。</li>
<li>报告转发分组出错。</li>
</ol>
</li>
<li><p>路由表的作用：<strong>指出到某个网络应当先到某个路由器（即下一跳路由器）。</strong>它没有给分组指明到某个网络的完整路径，而是指引分组<strong>一步步</strong>进行查找和转发，直到到达目的网络。</p>
</li>
</ol>
<ol>
<li><p><strong>划分子网</strong>：</p>
<ol>
<li><p>从<strong>两级</strong> IP 地址<strong>（网络号+主机号）</strong>到<strong>三级</strong> IP 地址<strong>（网络号+子网号+主机号）</strong></p>
<ol>
<li>原因：在 ARPANET 的早期，IP 地址的设计确实不够合理：<ol>
<li>IP 地址空间的<strong>利用率有时很低</strong>。</li>
<li>给每一个物理网络分配一个网络号会<strong>使路由表变得太大</strong>因而使网络性能变坏</li>
<li>两级的 IP 地址<strong>不够灵活</strong></li>
</ol>
</li>
<li>从 1985 年起在 IP 地址中又增加了一个“子网号字段”，使两级的 IP 地址变成为三级的 IP 地址。</li>
</ol>
</li>
<li><p>划分子网纯属一个<strong>单位内部</strong>的事情。单位对外仍然表现为没有划分子网的网络。<strong>子网对外部透明</strong>。外部主机只需要将IP数据报发送给该单位的网络，发送到具体的子网由该单位自己负责。</p>
</li>
<li><p>方法：<strong>从主机号借用若干个位作为子网号 subnet-id，而主机号 host-id 也就相应减少了若干个位</strong>。凡是从其他网络发送给本单位某个主机的 IP 数据报，仍然是根据 IP 数据报的目的网络号 net-id，先找到连接在本单位网络上的路由器。然后此路由器在收到 IP 数据报后，再按目的网络号 net-id 和子网号 subnet-id 找到目的子网。最后就将 IP 数据报直接交付目的主机。（子网号全0或者全1表示特殊含义，所以n位的子网号，对应的子网数目为2n−12�−1。</p>
</li>
</ol>
</li>
</ol>
<pre><code>  ![子网](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/%E5%AD%90%E7%BD%91.png)

  **子网**
</code></pre><ol>
<li><p>优点</p>
<ol>
<li><strong>减少了 IP 地址的浪费</strong></li>
<li><strong>使网络的组织更加灵活</strong></li>
<li><strong>更便于维护和管理</strong></li>
</ol>
</li>
<li><p><strong>子网掩码</strong>：存放在路由器中，路由器在与相邻路由器交换信息时，需要给出所在网络的子网掩码，路由表中每一个目的网络地址后面也需要给出该目的网络的子网掩码。</p>
<ol>
<li><p>规则：</p>
<ol>
<li>子网掩码长度 ＝ 32 位（IPv4）</li>
<li>某位 ＝ 1：IP地址中的对应位为网络号和子网号</li>
<li>某位 ＝ 0：IP地址中的对应位为主机号</li>
</ol>
</li>
<li><p>使用时，计算机将子网掩码和目的地址进行<strong>按位与</strong>运算。</p>
</li>
</ol>
</li>
</ol>
<pre><code>     ![子网掩码](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81.png)

     **子网掩码**



  3. 划分方法：

     1. **固定长度子网**：所有子网的子网掩码都是相同的。
     2. **变长子网**

  4. 划分子网增加了灵活性，但却**减少了能够连接在网络上的主机总数**。（**每个子网的主机号全0或全1均保留**）
</code></pre><ol>
<li><p><strong>ICMP协议：网际控制报文协议Internet Control Message Protocol</strong></p>
<ol>
<li>ICMP<strong>允许主机或路由器报告差错情况和提供有关异常情况的报告</strong>。从而更有效地转发IP数据报和提高交付成功的机会。</li>
</ol>
</li>
</ol>
<pre><code>   ![ICMP报文](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/ICMP%E6%8A%A5%E6%96%87.png)

   **ICMP报文**



2. ICMP属于**网络层协议**，**ICMP报文存在于IP数据报的数据部分。**ICMP报文分为差错报告报文和询问报文。

3. **ICMP差错报告报文**：

   1. 类型：
      1. **终点不可达**
      2. **时间超过**
      3. **参数问题**
      4. **改变路由**（重定向）Redirect��������（存在更好的路径）
   2. **首部8个字节**，数据部分**为需要进行差错报告的IP数据报的首部和数据部分前8个字节。**

4. **ICMP 询问报文**：

   1. 回送请求和回答报文（PING命令）
   2. 时间戳请求和回答报文

5. ICMP举例：

   1. **PING**：用来测试**两个主机之间的连通性**。PING 使用了 **ICMP 回送请求与回送回答报文**。PING 是**应用层直接使用网络层 ICMP 的例子**，它没有通过运输层的 TCP 或UDP。



      ![PING](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/PING.png)

      **PING**



   2. **Traceroute**：Windows 操作系统中这个命令是 tracert。**用来跟踪一个分组从源点到终点的路径**。它利用 IP 数据报中的 TTL 字段和 ICMP 时间超过差错报告报文实现对从源点到终点的路径的跟踪。



      ![traceroute](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/traceroute.png)

      **traceroute**
</code></pre><ol>
<li><p>互联网的路由选择协议：</p>
<ol>
<li><p>路由route：<strong>为分组找路径。</strong></p>
</li>
<li><p>理想的路由算法：</p>
<ol>
<li>算法必须是正确的和完整的。</li>
<li>算法在计算上应简单。</li>
<li>算法应能适应通信量和网络拓扑的变化，这就是说，要有自适应性。</li>
<li>算法应具有稳定性。</li>
<li>算法应是公平的。</li>
<li>算法应是最佳的。</li>
</ol>
</li>
<li><p>按照路由选择算法是否能<strong>随着网络的通信量或者拓扑自适应地进行调整变化</strong>来划分：</p>
<ol>
<li><strong>静态路由选择策略</strong>——即非自适应路由选择，其特点是<strong>简单和开销较小</strong>，但<strong>不能及时适应网络状态的变化。</strong></li>
<li><strong>动态路由选择策略</strong>——即自适应路由选择，其特点是<strong>能较好地适应网络状态的变化，但实现起来较为复杂，开销也比较大。</strong>、、</li>
</ol>
</li>
<li><p>互联网采用<strong>自适应的（动态）、分层次的</strong>路由选择协议。</p>
<ol>
<li>互联网的规模非常大。如果让所有的路由器知道所有的网络应怎样到达，则这种路由表将非常大，处理起来也太花时间。而所有这些路由器之间交换路由信息所需的带宽就会使互联网的通信链路饱和。</li>
<li>许多单位不愿意外界了解自己单位网络的布局细节和本部门所采用的路由选择协议（这属于本部门内部的事情），但同时还希望连接到互联网上。</li>
</ol>
</li>
<li><p><strong>自治系统AS Autonomous System \</strong>：<strong>在单一的技术管理下的一组路由器</strong>，而这些路由器使用<strong>一种 AS 内部的路由选择协议（如RIP和OSPF）和共同的度量</strong>以确定分组在该 AS 内的路由，同时还使用<strong>一种 AS 之间的路由选择协议（如BGP-4）</strong>用以确定分组在 AS之间的路由。一个 AS 对其他 AS 表现出的是一个单一的和一致的路由选择策略。（自治系统相连采用的是<strong>网关Gateway）</strong></p>
</li>
</ol>
</li>
</ol>
<pre><code>   ![AS](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/%E8%87%AA%E6%B2%BB%E7%B3%BB%E7%BB%9F.png)

   **AS**



6. **内部网关协议 IGP** InteriorGatewayProtocol����������������������� （自治系统内部）

   1. 在一个**自治系统内部**使用的路由选择协议。
   2. 目前这类路由选择协议使用得最多，如 **RIP 和 OSPF 协议。**

7. **外部网关协议 EGP** ExternalGatewayProtocol����������������������� （自治系统之间）

   1. 若源站和目的站**处在不同的自治系统**中，当数据报传到一个自治系统的边界时，就需要使用一种协议将路由选择信息传递到另一个自治系统中。这样的协议就是外部网关协议 EGP。
   2. 在外部网关协议中目前使用最多的是 **BGP-4**。

8. 内部网关协议 **RIP（路由信息协议）**

   1. **路由信息协议 RIP RoutingInformationProtocol��������������������������** 是内部网关协议 IGP 中**最先**得到广泛使用的协议。

   2. RIP 是一种**分布式的、基于距离向量的**路由选择协议。

   3. RIP 协议要求网络中的每一个路由器都要维护**从它自己到其他每一个目的网络的距离记录**。

   4. RIP中的距离也称为**“跳数”hopcountℎ�������\**，**因为每经过一个路由器，跳数就加 1。直接相连的路由器跳数为1。**

   5. RIP 认为一个好的路由就是**它通过的路由器的数目少，即“距离短”**。（但其实不一定，**有的路径可能速度更快但路由数较多**）

   6. RIP 允许一条路径最多只能包含 **15 个**路由器。“距离”的最大值为 16 时即相当**于不可达**。可见 RIP 只适用于**小型互联网**。

   7. RIP协议的特点：

      1. 仅和**相邻路由器**交换信息。
      2. 交换的信息是当前本路由器所知道的全部信息，即**自己的路由表**。
      3. 按**固定的时间间隔**交换路由信息，例如，每隔 30 秒。当网络拓扑发生变化时，路由器也及时向相邻路由器通告拓扑变化后的路由信息。

   8. 路由器在刚刚开始工作时，只知道**到直接连接的网络的距离（此距离定义为 1）**。它的路由表是空的。经过若干次**交换信息和更新**后，所有的路由器最终都会知道到达本自治系统中任何一个网络的最短距离和下一跳路由器的地址。**这个若干次更新的过程即为RIP的收敛**。

   9. RIP协议的路由器之间交换信息的方式是：**RIP报文**。它使用运输层的**用户数据报协议UDP**进行传送。

   10. RIP协议的更新路由表算法：**距离向量算法**：

       1. 路由器收到**相邻路由器**（其地址为 X）的一个 RIP 报文。
       2. 先修改此 RIP 报文中的所有项目：**把“下一跳”字段中的地址都改为 X，并把所有的“距离”字段的值加 1。**
       3. 对修改后的 RIP 报文中的每一个项目，重复以下步骤：
          1. 若项目中的目的网络**不在路由表**中，则把该项目加到路由表中。（**新的目的网络**）
          2. 否则：
             1. 若下一跳字段给出的**路由器地址是同样的**，则把收到的项目**替换**原路由表中的项目。（**网络动态更新后的最新的消息**）
             2. 否则：
                1. 若收到项目中的距离**小于**路由表中的距离，则进行更新（**更好的路径**）
                2. 否则，什么也不做。
       4. 若 **3 分钟**还没有收到相邻路由器的更新路由表，则把此相邻路由器记为不可达路由器，即将距离**置为 16**（表示不可达）。
       5. 返回。

   11. 距离向量算法的基础就是 **Bellman-Ford 算法**（**SPFA算法前身**）

   12. RIP 协议特点：**好消息传播得快，坏消息传播得慢。**当网络出现故障时，要经过比较长的时间 例如数分钟例如数分钟 才能将此信息传送到所有的路由器。（**故障的链路对路由表的修改在还未发送出去时，可能被收到的相邻路由器尚未更新的路由表信息覆盖掉**）

   13. 优点：

       1. **实现简单，开销较小。**

   14. 缺点：

       1. RIP **限制了网络的规模**，它能使用的最大距离为 15（16 表示不可达）。
       2. 路由器之间交换的路由信息是**路由器中的完整路由表**，因而随着网络规模的扩大，**开销也就增加。**
       3. “坏消息传播得慢”，使**更新过程的收敛时间过长**。



       ![距离向量算法](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/%E8%B7%9D%E7%A6%BB%E5%90%91%E9%87%8F.png)

       **距离向量算法**



9. 内部网关协议 OSPF（**开放最短路径优先协议**）

   1. **开放最短路径优先 OSPF OpenShortestPathFirst�����ℎ���������ℎ�����\**是为**克服 RIP 的缺点**在 1989 年开发出来的。

      1. “开放”表明 OSPF 协议不是受某一家厂商控制，而是**公开发表**的。
      2. “最短路径优先”是因为使用了 **Dijkstra 提出的动态规划的最短路径算法 SPF**。注意：OSPF 只是一个协议的名字，它并不表示其他的路由选择协议不是“最短路径优先”。
      3. 采用**分布式**的链路状态协议 linkstateprotocol�����������������。

   2. 三大要点：

      1. 向本自治系统中所有路由器发送信息，这里使用的方法是**洪泛法**。路由器通过所有的端口向所有的相邻路由器发送信息，而所有的相邻路由器也是同样的做法，（但发送的对象不包括之前向他发送信息的那个路由器），从而最终**使得整个局域网都得到该信息的一个副本。**
      2. 发送的信息就是**与本路由器相邻的所有路由器的链路状态**，但这只是路由器所知道的部分信息。（Dijkstra算法只需要相邻链路状态即可获取最短路径）
      3. 只有**当链路状态发生变化**时，路由器才用洪泛法向所有路由器发送此信息。

   3. 由于各路由器之间频繁地交换链路状态信息，因此所有的路由器最终都能建立一个**链路状态数据库**。这个数据库实际上就是全网的拓扑结构图，它在全网范围内是**一致**的（**这称为链路状态数据库的同步**）。OSPF 的链路状态数据库能**较快地进行更新**，使各个路由器能及时更新其路由表。

   4. 优点：

      1. OSPF 的更新过程**收敛得快**；

      2. OSPF 没有“**坏消息传播得慢**”的问题

      3. OSPF 能够用于**规模很大**的网络，采用**划分区域**的方式。

         1. 划分区域的好处就是**将利用洪泛法交换链路状态信息的范围局限于每一个区域而不是整个的自治系统**，这就减少了整个网络上的通信量。在一个区域内部的路由器只知道本区域的完整网络拓扑，而不知道其他区域的网络拓扑的情况。



         ![划分区域](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/%E5%88%92%E5%88%86%E5%8C%BA%E5%9F%9F.png)

         **划分区域**



   5. OSPF 不用 UDP 而是直接用 **IP 数据报**传送。（**RIP使用UDP**）



      ![OSPF分组](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/OSPF%E5%88%86%E7%BB%84.png)

      **OSPF分组**



10. **路由器**：

    1. 路由器是一种典型的**网络层设备**。**作用是连通不同的网络（局域网），进行分组转发**。

    2. 路由器是互联网的核心部分中的关键设备。

    3. 路由器的主要作用是：

       1. **连通不同的网络。**
       2. **选择信息传送的线路（路由选择协议）**。选择通畅快捷的近路，能大大提高通信速度，减轻网络系统通信负荷，节约网络系统资源，提高网络系统畅通率，从而让网络系统发挥出更大的效益来。



       ![路由器](https://hillzhang1999.gitee.io/2020/05/22/ji-suan-ji-wang-luo-quan-bu-fu-xi-bi-ji/%E8%B7%AF%E7%94%B1%E5%99%A8.png)

       **路由器**



    4. “转发”和“路由选择”的区别 :

       1. “转发”forwarding���������� 就是路由器根据转发表将用户的 IP 数据报**从合适的端口**转发出去。
       2. “路由选择”routing������� 则是按照**分布式算法**，根据从各相邻路由器得到的关于网络拓扑的变化情况，**动态地改变所选择的路由**。
       3. **路由表是根据路由选择算法得出的。而转发表是从路由表得出的。**

11. IPv6:

    1. 网际协议IP 是互联网的核心协议。
    2. 互联网经过几十年的飞速发展，**到 2011 年 2 月，IPv4 的 32 位地址已经耗尽。**
    3. 解决 IP 地址耗尽的根本措施就是**采用具有更大地址空间的新版本的 IP，即 IPv6。**
    4. 所引进的主要变化：
       1. **更大的地址空间。IPv6 将地址从 IPv4 的 32 位 增大到了 128 位。**
       2. **扩展的地址层次结构。**
       3. **灵活的首部格式**。 IPv6 定义了许多可选的扩展首部。
       4. **改进的选项**。 IPv6 允许数据报包含有选项的控制信息，其选项放在有效载荷中。
       5. **允许协议继续扩充**。
       6. **支持即插即用（即自动配置）**。因此 IPv6 不需要使用 DHCP。
       7. **支持资源的预分配**。 IPv6 支持实时视像等要求，保证一定的带宽和时延的应用。
       8. **IPv6 首部改为 8 字节对齐**。首部长度必须是 8 字节的整数倍。原来的 IPv4 首部是 4 字节对齐。
    5. 由于IPv6改为了128位，所以并没有采用和IPv4相同的点分十进制表示法，而是采用**冒号十六进制记法**。
</code></pre></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">Jerry Jiang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2023/11/09/%E8%AE%A1%E7%BD%91%E7%AC%AC%E5%9B%9B%E7%AB%A0/">http://example.com/2023/11/09/%E8%AE%A1%E7%BD%91%E7%AC%AC%E5%9B%9B%E7%AB%A0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Jerryの魔法小屋</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://imageurlbed.oss-cn-shenzhen.aliyuncs.com/img/mountains-7750722_1920.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/11/10/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%80%E7%AB%A0/" title="操作系统第一章"><img class="cover" src="https://imageurlbed.oss-cn-shenzhen.aliyuncs.com/img/mountains-7750722_1920.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">操作系统第一章</div></div></a></div><div class="next-post pull-right"><a href="/2023/11/09/%E8%AE%A1%E7%BD%91%E7%AC%AC%E4%B9%9D%E7%AB%A0/" title="计网第九章"><img class="cover" src="https://imageurlbed.oss-cn-shenzhen.aliyuncs.com/img/mountains-7750722_1920.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">计网第九章</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://imageurlbed.oss-cn-shenzhen.aliyuncs.com/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Jerry Jiang</div><div class="author-info__description">赞美太阳！</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/etherea1ity"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/etherea1ity" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:jsj31415926@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的小屋！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="toc-number">1.</span> <span class="toc-text">第四章 网络层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E8%A6%81%E5%86%85%E5%AE%B9"><span class="toc-number">1.1.</span> <span class="toc-text">重要内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">1.2.</span> <span class="toc-text">核心知识点</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/11/10/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%80%E7%AB%A0/" title="操作系统第一章"><img src="https://imageurlbed.oss-cn-shenzhen.aliyuncs.com/img/mountains-7750722_1920.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="操作系统第一章"/></a><div class="content"><a class="title" href="/2023/11/10/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%80%E7%AB%A0/" title="操作系统第一章">操作系统第一章</a><time datetime="2023-11-10T06:07:21.000Z" title="发表于 2023-11-10 14:07:21">2023-11-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/09/%E8%AE%A1%E7%BD%91%E7%AC%AC%E5%9B%9B%E7%AB%A0/" title="计网第四章"><img src="https://imageurlbed.oss-cn-shenzhen.aliyuncs.com/img/mountains-7750722_1920.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="计网第四章"/></a><div class="content"><a class="title" href="/2023/11/09/%E8%AE%A1%E7%BD%91%E7%AC%AC%E5%9B%9B%E7%AB%A0/" title="计网第四章">计网第四章</a><time datetime="2023-11-09T12:05:34.000Z" title="发表于 2023-11-09 20:05:34">2023-11-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/09/%E8%AE%A1%E7%BD%91%E7%AC%AC%E4%B9%9D%E7%AB%A0/" title="计网第九章"><img src="https://imageurlbed.oss-cn-shenzhen.aliyuncs.com/img/mountains-7750722_1920.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="计网第九章"/></a><div class="content"><a class="title" href="/2023/11/09/%E8%AE%A1%E7%BD%91%E7%AC%AC%E4%B9%9D%E7%AB%A0/" title="计网第九章">计网第九章</a><time datetime="2023-11-09T06:00:38.000Z" title="发表于 2023-11-09 14:00:38">2023-11-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/30/commonlit/" title="commonlit competition review"><img src="https://imageurlbed.oss-cn-shenzhen.aliyuncs.com/img/commonlit.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="commonlit competition review"/></a><div class="content"><a class="title" href="/2023/10/30/commonlit/" title="commonlit competition review">commonlit competition review</a><time datetime="2023-10-30T13:53:55.000Z" title="发表于 2023-10-30 21:53:55">2023-10-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/30/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%AE%BA%E6%80%BB%E7%BB%93/" title="数据库系统概论总结"><img src="https://imageurlbed.oss-cn-shenzhen.aliyuncs.com/img/DATABASECARTOON.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库系统概论总结"/></a><div class="content"><a class="title" href="/2023/10/30/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%AE%BA%E6%80%BB%E7%BB%93/" title="数据库系统概论总结">数据库系统概论总结</a><time datetime="2023-10-30T10:33:39.000Z" title="发表于 2023-10-30 18:33:39">2023-10-30</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Jerry Jiang</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>